# PRD v0.2 — Project Rewire（配電盤燒線 Demo / 回饋強化版）

## 0. 版本摘要

v0.2 建立在 v0.1 已完成的基礎上，聚焦於三個方向：
1. **視聽回饋強化** — 讓「過載→燒毀」的過程更有臨場感
2. **材料擴充** — 補齊台灣常用線材與 220V 電器
3. **關卡擴充** — 利用新材料設計進階關卡

> v0.1 所有功能需求維持不變，本文件僅描述 **增量（delta）** 內容。


## 1. 產品目標（This release）

在 v0.1 的基礎上：
1. 過載預警階段就能「聽到、看到」危險正在逼近（滋滋聲 + 冒煙）
2. 燒毀瞬間的視覺衝擊感（明火 + 斷線 + 絕緣皮剝落）
3. 送電後電器有簡易運作反饋（聲音 + 動畫）
4. 引入 220V 電器與更多線材，增加策略深度
5. 新關卡利用 220V 場景與更多線材選擇

### 非目標（Not in v0.2）
- 不做拖拉接線（Drag & Drop）— 留到 v0.3
- 不做多迴路 / 多 NFB
- 不做相位平衡（紅/黑火線）
- 不做弱電 / 網路


## 2. 功能需求（Functional Requirements）

### FR-7：過載預警回饋強化（Warning Feedback Enhancement）

v0.1 的 warning 狀態只有線色變化，缺乏音效與煙霧。

**新增行為：**
- **滋滋聲（Buzzing Sound）**：進入 warning 狀態後，播放持續性低頻電流嗡嗡聲，音量隨 wireHeat 漸增
- **預警冒煙**：wireHeat ≥ 0.3 時，接點處開始出現淡煙粒子（透明度較低、上升速度較慢），與 burned 的濃煙區分

**驗收條件：**
- warning 狀態下可聽到持續嗡嗡聲
- wireHeat 從 0.3 開始出現淡煙，0.7 以上煙霧明顯加濃
- 回到 normal 狀態時音效與煙霧停止


### FR-8：燒毀視覺強化（Burn Visual Enhancement）

v0.1 的 burned 狀態只有線色變黑與煙霧粒子，缺乏衝擊感。

**新增行為：**
- **明火特效（Fire Particles）**：燒毀瞬間在過載點產生火焰粒子（橘紅色，向上飄散後消失）
- **電線斷裂**：SVG 線段在燒毀點斷開，形成缺口
- **絕緣皮剝落**：斷裂處顯示外皮翻開、露出銅色內芯的視覺效果

**驗收條件：**
- burned 觸發時同時出現火焰粒子 + 煙霧
- 電線在 SVG 上可見斷裂缺口
- 斷裂處可見銅色線芯


### FR-9：電器運作反饋（Appliance Operation Feedback）

v0.1 送電後電器無任何運作反饋，缺少「成功通電」的成就感。

**新增行為：**
- **運作音效**：每種電器在通電後播放對應的環境音（吹風機風聲、快煮壺水滾聲等），使用 Web Audio API 合成
- **運作動畫**：電器圖示在通電後加入簡易 CSS 動畫（例如：吹風機旋轉、快煮壺冒泡、微波爐亮燈）

**驗收條件：**
- 送電後每個已插電器播放對應音效
- 電器在電路圖或面板上有可見的運作動畫
- 斷電 / 跳電 / 燒毀時音效與動畫立即停止


### FR-10：材料擴充（Extended Materials）

v0.1 只有 3 種線材與 3 種電器，策略空間有限。

**新增線材：**

| 線徑 | 類型 | 安全電流 | 成本/米 | 說明 |
|---|---|---|---|---|
| 3.5mm² | 絞線 | 25A | $8 | 過渡規格，介於 2.0 與 5.5 之間 |
| 8mm² | 絞線 | 45A | $18 | 大電流用，總電源入戶線等級 |

**新增電器：**

| 電器 | 功率 | 電壓 | 電流 | 說明 |
|---|---|---|---|---|
| 廚下加熱器 | 800W | 110V | 7.3A | 低功率持續性負載 |
| 烘衣機 | 2200W | 220V | 10A | 首款 220V 電器 |

**220V 電流計算：**
- 烘衣機 2200W / 220V = 10A，看似不大但需專用迴路
- NFB 額定與線徑選擇邏輯不變，僅電流計算公式中的 V 改為 220

**驗收條件：**
- 線材庫顯示 5 種線材，電器庫顯示 5 種電器
- 220V 電器正確以 220V 計算電流
- 新線材與電器可在模擬引擎中正常運作


### FR-11：關卡擴充（Extended Levels）

利用新材料設計進階關卡。

**新增關卡：**

#### L04 低功率陷阱
- **電器**：廚下加熱器 (800W) + 吹風機 (1200W) + 快煮壺 (1500W)
- **預算**：$55
- **存活時間**：5 秒
- **設計意圖**：三台 110V 電器合計 31.8A，迫使玩家選 5.5mm² 但預算緊繃；引入 3.5mm² 作為中間選項（25A 不夠，所以 3.5mm² 是陷阱）

#### L05 220V 專用迴路
- **電器**：烘衣機 (2200W/220V)
- **預算**：$60
- **存活時間**：5 秒
- **設計意圖**：首次接觸 220V 電器，電流只有 10A 看似溫和，但要理解 220V 的計算方式；低預算限制線材選擇

#### L06 混合電壓挑戰
- **電器**：烘衣機 (2200W/220V) + 吹風機 (1200W/110V)
- **預算**：$80
- **存活時間**：8 秒
- **設計意圖**：混合電壓情境，總電流 = 10 + 10.9 = 20.9A，剛好超過 2.0mm² 上限；存活時間拉長增加緊張感

**驗收條件：**
- L04-L06 可從關卡選擇畫面進入
- 各關卡使用正確的電器組合與預算
- 關卡難度遞增，設計意圖可驗證


## 3. 更新後的完整數據表

### 線材（5 種）

| 線徑 | 類型 | 安全電流 | 成本/米 |
|---|---|---|---|
| 1.6mm² | 單芯線 | 15A | $3 |
| 2.0mm² | 單芯線 | 20A | $5 |
| 3.5mm² | 絞線 | 25A | $8 |
| 5.5mm² | 絞線 | 30A | $12 |
| 8mm² | 絞線 | 45A | $18 |

### 電器（5 種）

| 電器 | 功率 | 電壓 | 電流 |
|---|---|---|---|
| 吹風機 | 1200W | 110V | 10.9A |
| 快煮壺 | 1500W | 110V | 13.6A |
| 微波爐 | 1100W | 110V | 10.0A |
| 廚下加熱器 | 800W | 110V | 7.3A |
| 烘衣機 | 2200W | 220V | 10.0A |

### NFB（不變）
- 20A，跳脫閾值 1.25× = 25A
- 跳脫延遲：1.5 秒


## 4. 後續版本方向（Roadmap Preview）

- **v0.3**：拖拉接線（Drag & Drop）互動、多迴路 / 多 NFB
- **v0.4**：紅黑相位平衡與中性線電流、ELCB 漏電斷路器
- **v0.5**：整線系統與美觀評分、老屋驚魂模式
- **v1.0**：弱電箱與網路系統模擬
