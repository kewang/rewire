## Context

目前遊戲已支援多迴路（L06-L08），電器也已有 `voltage` 欄位（110/220），但迴路本身沒有電壓屬性。烘衣機（220V）可以被分配到任何迴路，與 110V 電器混用，玩家無法理解 110V/220V 的差異與專用迴路的概念。

FR-B 多迴路基礎架構已完成，包含 CircuitConfig、per-circuit 接線/電器分配、stepMulti() 模擬。現在需要在此基礎上加入電壓維度。

## Goals / Non-Goals

**Goals:**
- 迴路具備電壓屬性，220V 迴路與 110V 迴路在行為和視覺上有明確區分
- 電壓相容性成為電器分配的約束條件（220V 電器 → 220V 迴路）
- SVG 視覺上可明確辨識 110V vs 220V 迴路（線型、插座、NFB）
- 新增混合電壓關卡讓玩家實際體驗電壓分配策略

**Non-Goals:**
- 不實作電壓不匹配的物理模擬（如 220V 插 110V 會燒機器）— 直接在 UI 層阻擋
- 不實作三相電（380V）— 家用配電僅涉及單相 110V/220V
- 不實作個別迴路獨立 NFB 開關控制 — 維持全域送電
- 不新增 220V 電器種類（如 IH 爐）— 留給 v0.4

## Decisions

### D1: CircuitConfig.voltage 欄位 — 使用 `110 | 220` literal type

**決策**: 在 `CircuitConfig` 新增 `voltage: 110 | 220` 必填欄位。

**替代方案**: 用 enum（`Voltage.V110`）或 string（`'110V'`）。
**理由**: 數字 literal 與 Appliance.voltage 一致，且可直接做數學計算（電流 = P/V），不需轉換。`Circuit` interface 也從 CircuitConfig 繼承 voltage。

### D2: 電壓相容性 — UI 層過濾 + 引擎層防禦性檢查

**決策**:
- AppliancePanel 依迴路電壓過濾可用電器（主要阻擋點）
- simulation.step() 加防禦性 assert：若電器與迴路電壓不匹配則忽略該電器（不計入電流）

**替代方案**: 只在 UI 擋 / 在引擎加新的 `voltageMismatch` 狀態。
**理由**: UI 擋是主要手段（玩家不可能接錯），引擎防禦只是安全網。新增模擬狀態會複雜化 SimulationStatus 且無遊戲體驗價值。

### D3: 220V 視覺表現 — 雙線 + T 型插座 + 2P NFB

**決策**:
- **線路**: 220V 迴路用雙平行線（間距 4px，紅+黑），110V 維持單線
- **插座**: 220V 用 T 型插座 SVG（台灣 NEMA 6 樣式），110V 用現有雙扁插座
- **NFB**: 220V 標示 "2P" 文字 + 寬度加倍（佔兩格 DIN rail），110V 維持現有 "1P"
- **電壓標籤**: 迴路名稱旁顯示小標籤 "110V" / "220V"

**理由**: 三種視覺差異互相強化，玩家可快速辨識迴路電壓。雙線是最直覺的 220V 表示（實際配電中 220V 需紅黑兩根火線）。

### D4: 關卡設計策略 — 漸進引入

**決策**:
- L06-L07 維持全 110V（向後相容，不干擾現有學習曲線）
- L08 改為混合電壓（c3 改為 220V 專用迴路給烘衣機）
- 新增 L09「混合電壓挑戰」— 2 條 110V + 1 條 220V，需正確分配

**替代方案**: 所有多迴路關卡都加入電壓區分。
**理由**: 漸進式引入，L06-L07 先學多迴路分配，L08 引入電壓概念，L09 強化練習。

### D5: 單迴路向後相容 — voltage 預設 110

**決策**: `createSingleCircuitLevel` helper 自動設 voltage=110。現有 L01-L05 不需修改。

**理由**: 所有單迴路關卡都是 110V 場景，無需顯示電壓標籤（僅有一種時沒有區分意義）。多迴路時才顯示電壓標示。

## Risks / Trade-offs

- **SVG 複雜度增加** → 220V 雙線渲染路徑較多，但 SingleCircuitSVG 已封裝良好，影響可控
- **L08 規格變更** → 已有玩家可能習慣舊 L08，但遊戲仍在 v0.3 開發階段，可接受
- **電壓過濾可能導致混淆** → 玩家可能不理解為何某些電器無法選擇 → 在 disabled 電器上加 tooltip「需要 220V 迴路」
