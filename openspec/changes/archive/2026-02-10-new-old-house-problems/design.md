## Context

è€å±‹é©šé­‚æ¨¡å¼ï¼ˆv0.5 å»ºç«‹ï¼‰ç›®å‰æœ‰ 3 ç¨®å•é¡Œé¡å‹ï¼Œå…¨éƒ¨éœ€è¦æ‹†ç·šé‡æ¥ã€‚v0.8 PRD è¦æ±‚æ“´å……è‡³ 5 ç¨®ï¼Œæ–°å¢ `overrated-breaker`ï¼ˆNFB éå¤§ï¼‰èˆ‡ `missing-elcb`ï¼ˆç¼ºæ¼é›»ä¿è­·ï¼‰ï¼Œå…©è€…éƒ½ä¸éœ€æ‹†ç·šï¼Œé€éæ›´æ›è¨­å®šå³å¯ä¿®å¾©ã€‚åŒæ™‚æ–°å¢ L24â€“L25 é—œå¡è®“ç©å®¶é¦–æ¬¡é«”é©—æ–°å•é¡Œé¡å‹ã€‚

ç¾æœ‰æ¶æ§‹ï¼š
- `OldHouseProblemType` union type åœ¨ `game.ts`
- `GameBoard` é€é `problemCircuits` state è¿½è¹¤å•é¡Œã€`preWiredCircuitIds` è¿½è¹¤é æ¥ç·š
- `CircuitDiagram` é¡¯ç¤ºå•é¡Œè¦–è¦ºï¼ˆé–ƒçˆæ©˜è‰²é‚Šæ¡† + âš ï¸ï¼‰
- å•é¡Œä¿®å¾©åˆ¤å®šï¼šæ‹†ç·š â†’ é‡æ¥ â†’ å£“æ¥ â†’ å¾ problemCircuits ç§»é™¤

## Goals / Non-Goals

**Goals:**
- æ“´å…… OldHouseProblemType æ–°å¢ 2 ç¨®å•é¡Œé¡å‹
- å»ºç«‹ NFB æ›´æ› UIï¼ˆBreakerSelectorï¼‰ï¼Œåƒ…é™è€å±‹ overrated-breaker è¿´è·¯ä½¿ç”¨
- æ“´å……å•é¡Œè§£æ±ºé‚è¼¯ï¼Œæ”¯æ´ä¸éœ€æ‹†ç·šçš„ä¿®å¾©è·¯å¾‘
- æ–°å¢ overrated-breaker / missing-elcb å°ˆå±¬è¦–è¦ºæ¨™ç¤º
- å®šç¾© L24ã€L25 é—œå¡

**Non-Goals:**
- ä¸åšéè€å±‹æ¨¡å¼çš„ NFB æ›´æ›ï¼ˆæ­£å¸¸é—œå¡ä¸å¯æ› NFBï¼‰
- ä¸åš Before/After ä¿®å¾©å°æ¯”ï¼ˆä¸‹ä¸€å€‹ changeï¼‰
- ä¸åšéš¨æ©Ÿè€å±‹ç”Ÿæˆå™¨ï¼ˆå¾ŒçºŒ changeï¼‰
- ä¸åšè€å±‹ + èµ°ç·šæ•´åˆï¼ˆå¾ŒçºŒ changeï¼‰
- NFB æ›´æ›å…è²»ï¼Œä¸åšæˆæœ¬æ¨¡å‹

## Decisions

### D1: circuitBreakers state ç®¡ç† NFB è¦æ ¼

**é¸æ“‡**: GameBoard æ–°å¢ `circuitBreakers: Record<CircuitId, Breaker>` stateï¼Œé€²å…¥é—œå¡æ™‚å¾ `CircuitConfig.breaker` åˆå§‹åŒ–ï¼ˆè€å±‹ overrated-breaker è¿´è·¯å‰‡å¾ PreWiredCircuit çš„ breaker åˆå§‹åŒ–ï¼‰ã€‚

**æ›¿ä»£æ–¹æ¡ˆ**: ç›´æ¥ä¿®æ”¹ CircuitConfig â€” ä¸å¯è¡Œï¼ŒCircuitConfig ä¾†è‡ª Level å®šç¾©ï¼Œä¸æ‡‰è¢« mutateã€‚

**ç†ç”±**: èˆ‡ circuitWires/circuitCrimps/circuitElcb ç­‰æ—¢æœ‰ per-circuit state æ¨¡å¼ä¸€è‡´ï¼Œä¿æŒ Level è³‡æ–™ä¸å¯è®Šã€‚

### D2: overrated-breaker å•é¡Œè§£æ±ºä¸éœ€æ‹†ç·š

**é¸æ“‡**: overrated-breaker çš„ä¿®å¾©åˆ¤å®šç‚º `circuitBreakers[id].ratedCurrent <= wire.maxCurrent`ï¼Œè§¸ç™¼æ¢ä»¶ç‚ºæ›´æ› NFBã€‚ä¸å½±éŸ¿å·²æ¥ç·šæå’Œå£“æ¥ç‹€æ…‹ã€‚

**ç†ç”±**: PRD æ˜ç¢ºæŒ‡å‡º overrated-breaker ä¸éœ€æ‹†ç·šï¼Œèˆ‡å‰ 3 ç¨®å•é¡Œå½¢æˆå€åˆ¥ã€‚ä¿®å¾©åˆ¤å®šé‚è¼¯ç°¡æ½”æ˜ç¢ºã€‚

### D3: missing-elcb å•é¡Œè§£æ±ºé€éæ—¢æœ‰ ELCB toggle

**é¸æ“‡**: missing-elcb çš„ä¿®å¾©åˆ¤å®šç‚º `circuitElcb[id] === true`ã€‚é‡ç”¨ CircuitDiagram æ—¢æœ‰çš„ ELCB toggleï¼ˆæˆ– CircuitCard çš„ ELCB toggleï¼‰ã€‚

**æ›¿ä»£æ–¹æ¡ˆ**: æ–°å¢å°ˆç”¨ ELCB å®‰è£ UI â€” ä¸å¿…è¦ï¼Œæ—¢æœ‰ toggle å·²èƒ½é”æˆã€‚

**ç†ç”±**: é›¶æ–° UIï¼Œæ•™è‚²æ•ˆæœå¥½ï¼ŒELCB æˆæœ¬ $35 ç…§å¸¸è¨ˆå…¥ã€‚

### D4: PreWiredCircuit æ“´å…… breaker æ¬„ä½

**é¸æ“‡**: `PreWiredCircuit` æ–°å¢å¯é¸ `breaker?: Breaker` æ¬„ä½ï¼Œoverrated-breaker å•é¡Œè¿´è·¯ä½¿ç”¨æ­¤æ¬„ä½æŒ‡å®šåˆå§‹çš„éå¤§ NFBã€‚æœªæŒ‡å®šæ™‚ä½¿ç”¨ CircuitConfig é è¨­ NFBã€‚

**ç†ç”±**: è®“é æ¥ç·šç‹€æ…‹èƒ½å®Œæ•´æè¿°è€å±‹åˆå§‹ NFB è¦æ ¼ï¼Œè‡ªç„¶æ“´å±•æ—¢æœ‰çµæ§‹ã€‚

### D5: BreakerSelector ç‚ºå½ˆå‡ºå¼é¸æ“‡å™¨

**é¸æ“‡**: é»æ“Šå•é¡Œè¿´è·¯ NFB â†’ å½ˆå‡º BreakerSelectorï¼ˆä¸‰å¼µ 15A/20A/30A å¡ç‰‡ï¼‰ï¼Œèˆ‡ WireSelector è¦–è¦ºé¢¨æ ¼ä¸€è‡´ã€‚é overrated-breaker è¿´è·¯çš„ NFB ä¸å¯é»æ“Šã€‚

**æ›¿ä»£æ–¹æ¡ˆ**: inline ä¸‹æ‹‰é¸å–® â€” å¤ªå°ï¼Œä¸å¤ æ˜ç¢ºã€‚

**ç†ç”±**: å¡ç‰‡å¼é¸æ“‡å™¨æ•™è‚²æ•ˆæœå¥½ï¼Œé¡¯ç¤ºé¡å®šé›»æµ + è·³è„«é–¾å€¼ + èˆ‡ç·šæç›¸å®¹æ€§æ¨™ç¤ºï¼Œè®“ç©å®¶ç†è§£ NFB èˆ‡ç·šæçš„é—œä¿‚ã€‚

### D6: å•é¡Œé¡å‹è¦–è¦ºå€åˆ†

**é¸æ“‡**:
- overrated-breakerï¼šNFB ä¸Šæ–¹ âš ï¸ + ç´…è‰²é‚Šæ¡†ï¼ˆèšç„¦åœ¨ NFB è€Œéæ•´æ¢ç·šï¼‰
- missing-elcbï¼šè¿´è·¯æ— ğŸ’§âš ï¸ï¼ˆæ°´æ»´+è­¦å‘Šï¼Œæš—ç¤ºæ½®æ¿•å±éšªï¼‰
- æ—¢æœ‰ 3 ç¨®å•é¡Œç¶­æŒé–ƒçˆæ©˜è‰²é‚Šæ¡† + âš ï¸

**ç†ç”±**: ä¸åŒè¦–è¦ºæš—ç¤ºç©å®¶ä¿®å¾©æ–¹å¼ä¸åŒï¼ˆNFB å•é¡Œçœ‹ NFBï¼ŒELCB å•é¡Œçœ‹ ğŸ’§ï¼‰ï¼Œå¢åŠ è¨ºæ–·æ¨‚è¶£ã€‚

### D7: å•é¡Œä¿®å¾©åˆ¤å®šæ“´å……ç‚ºçµ±ä¸€æª¢æŸ¥å‡½å¼

**é¸æ“‡**: å°‡å•é¡Œä¿®å¾©åˆ¤å®šå¾æ•£è½åœ¨ GameBoard çš„ if/else æ•´ç†ç‚ºä¸€å€‹ `isProblemResolved(problem, state)` ç´”å‡½å¼ï¼Œä¾å•é¡Œé¡å‹åˆ†æ´¾ä¸åŒåˆ¤å®šé‚è¼¯ã€‚

**ç†ç”±**: 5 ç¨®å•é¡Œé¡å‹å„æœ‰ä¸åŒä¿®å¾©è·¯å¾‘ï¼Œçµ±ä¸€å‡½å¼æé«˜å¯è®€æ€§å’Œå¯æ¸¬è©¦æ€§ã€‚

## Risks / Trade-offs

- **[åŒè¿´è·¯å¤šå•é¡Œ]** L26+ æœƒå‡ºç¾åŒè¿´è·¯æœ‰ overrated-breaker + wrong-wire-gaugeã€‚æœ¬æ¬¡ change åƒ…è™•ç† L24â€“L25ï¼ˆæ¯è¿´è·¯æœ€å¤š 1 å€‹å•é¡Œï¼‰ï¼Œä½† isProblemResolved è¨­è¨ˆæ™‚ MUST æ”¯æ´åŒè¿´è·¯å¤šå•é¡Œï¼ˆå„è‡ªç¨ç«‹åˆ¤å®šï¼‰ â†’ å¾ŒçºŒ change å¯ç›´æ¥ä½¿ç”¨
- **[BreakerSelector è§¸ç™¼æ–¹å¼]** éœ€åœ¨ SVG ä¸­çš„ NFB å€åŸŸåŠ ä¸Š click handlerï¼Œå¯èƒ½èˆ‡æ—¢æœ‰ leverTooltip è¡çª â†’ åƒ…åœ¨ overrated-breaker ä¸”æœªé€é›»æ™‚å•Ÿç”¨é»æ“Š
- **[missing-elcb èˆ‡æ—¢æœ‰ ELCB æ©Ÿåˆ¶æ•´åˆ]** è€å±‹åˆå§‹åŒ–æ™‚ missing-elcb è¿´è·¯çš„ circuitElcb MUST ç‚º falseï¼ˆæœªå®‰è£ï¼‰ï¼Œä½† CircuitConfig æœ‰ elcbAvailable=true â†’ ç¢ºä¿åˆå§‹åŒ–é †åºæ­£ç¢º
